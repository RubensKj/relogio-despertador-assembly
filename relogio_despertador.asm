	CALL INICIALIZA;
LOOP:
	CALL CHANGEMODE;
	CALL HANDLEDESPERTADOR;
	CALL DEVEDESPERTAR;
	CALL STARTCLOCK;
	CALL EXIBIRDADOS;

	JMP LOOP;

INICIALIZA:
// Despertador
	MOV 00,#FF;

// Horas Despertador
	MOV 00,#F4;
	MOV 00,#F3;

	MOV 00,#F2;
	MOV 00,#F1;

// Relogio
	MOV 00,#FC;
	MOV 00,#FB;

	MOV 00,#FA;
	MOV 00,#F9;

	MOV 00,#F8;
	MOV 00,#F7;
	RET;

// ========= Utils =========

EXIBIRDADOS:
	MOV #FF,A;
	MOV A,B;
	MOV A,C;
	MOV A,D;
	
	SUB 01,A;
	JMPZ DESPERTADORMODE;
	
	MOV B,A;
	SUB 03,A;
	JMPZ DESPERTADORMODE;

	MOV C,A;
	SUB 05,A;
	JMPZ DESPERTADORMODE;
	
	MOV D,A;
	SUB 07,A;
	JMPZ DESPERTADORMODE;

	JMP EXIBIRRELOGIO;
	RET;

EXIBIRRELOGIO:
	CALL SHOWUNIMIN;
	CALL SHOWDEZMIN;
	CALL SHOWUNIHORA;
	CALL SHOWDEZHORA;
	RET;

// ========= Despertador =========

CHANGEMODE:
	MOV IN0,A;
	MOV A,#FF;
	RET;
	
DESPERTADORMODE:
	CALL EXIBIRDESPERTADOR;
	RET;

EXIBIRDESPERTADOR:
	MOV #F4,A;
	MOV A,OUT0;
	MOV #F3,A;
	MOV A,OUT1;
	MOV #F2,A;
	MOV A,OUT2;
	MOV #F1,A;
	MOV A,OUT3;
	RET;

HANDLEDESPERTADOR:
	MOV #FF,A;
	MOV A,B;
	MOV A,C;

	SUB 03,A;
	JMPZ ADICIONAHORAS;

	MOV B,A;
	SUB 05,A;
	JMPZ ADICIONARMINUTOS;
	RET;

ADICIONAHORAS:
    MOV #F2,A;
	MOV A,B;
	SUB 03,A;
	JMPZ VALIDARDEZHORASDESP;
	JMP CONTINUARDESP;
	RET;

VALIDARDEZHORASDESP:
// DEZ HORA DESPERTADOR
    MOV #F1,A;
	SUB 02,A;
    JMPZ RESETARHORADESP;
	JMP CONTINUARDESP;
	RET;
	
RESETARHORADESP:
	MOV 00,#F2;
	MOV 00,#F1;
	RET;

CONTINUARDESP:
	MOV B,A;
	ADD 01,A;
	MOV A,B;

	SUB 0A,A;
	JMPZ INCREMENTARDEZHORADESP;

	MOV B,A;
	MOV A,#F2;
	RET;

INCREMENTARDEZHORADESP:
// Zera unidade horas despertador
	MOV 00,#F2;
	
	MOV #F1,A;
	ADD 01,A;
	MOV A,#F1;
	RET;

ADICIONARMINUTOS:
	MOV #F4,A;
	ADD 01,A;
	MOV A,B;

	SUB 0A,A;
	JMPZ ADDEXTRAMIN;
	
	MOV B,A;
	MOV A,#F4;

	RET;

ADDEXTRAMIN:
	MOV 00,#F4;

	MOV #F3,A;
	ADD 01,A;
	MOV A,B;

	SUB 06,A;
	JMPZ ADICIONAHORASLIMPANDOMINUTOS;
	
	MOV B,A;
	MOV A,#F3;

	RET;

ADICIONAHORASLIMPANDOMINUTOS:
	CALL LIMPAMINUTOS;
	CALL ADICIONAHORAS;
	RET;

LIMPAMINUTOS:
	MOV 00,#F3;
	RET;

// ========= Despertar =========

DEVEDESPERTAR:
	MOV #F7,A;
	SUB 80,A;
	JMPZ LIMPADESPERTADOR;

	MOV #F4,A;
	MOV A,B;
	MOV #FA,A;
	
	SUB B,A;
	JMPZ VALIDADEZMINUTOSDESPERTAR;
	RET;

LIMPADESPERTADOR:
	MOV A,#F7;
	RET;

VALIDADEZMINUTOSDESPERTAR:
	MOV #F3,A;
	MOV A,B;
	MOV #F9,A;
	
	SUB B,A;
	JMPZ VALIDAHORASDESPERTAR;
	RET;

VALIDAHORASDESPERTAR:
	MOV #F2,A;
	MOV A,B;
	MOV #F8,A;
	
	SUB B,A;
	JMPZ VALIDADEZHORASDESPERTAR;
	RET;

VALIDADEZHORASDESPERTAR:
	MOV #F1,A;
	MOV A,B;
	MOV #F7,A;
	
	SUB B,A;
	JMPZ DESPERTAR;
	RET;

DESPERTAR:
	MOV #F7,A;
	ADD 80,A;
	MOV A,#F7;
	RET;

// ========= Relogio =========

STARTCLOCK:
	CALL INCREMENTARUNISEC;
	RET;

INCREMENTARUNISEC:
	MOV #FC,A;
	ADD 01,A;
	MOV A,B;

	SUB 0A,A;
	JMPZ INCREMENTARDEZSEC;
	
	MOV B,A;
	MOV A,#FC;
	RET;

INCREMENTARDEZSEC:
// Zera unidade segundos
	MOV 00,#FC;

	MOV #FB,A;
	ADD 01,A;
	MOV A,B;

	SUB 06,A;
	JMPZ INCREMENTARUNIMIN;

	MOV B,A;
	MOV A,#FB;
	RET;

INCREMENTARUNIMIN:
// Zera dezena segundos
	MOV 00,#FB;

	MOV #FA,A;
	ADD 01,A;
	MOV A,C;

	SUB 0A,A;
	JMPZ INCREMENTARDEZMIN;
	
	MOV C,A;
	MOV A,#FA;
	RET;

INCREMENTARDEZMIN:
// Zera unidade minutos
	MOV 00,#FA;

	MOV #F9,A;
	ADD 01,A;
	MOV A,D;

	SUB 06,A;
	JMPZ INCREMENTARUNIHORA;

	MOV D,A;
	MOV A,#F9;
	RET;
	
INCREMENTARUNIHORA:
// Zera dezena minutos
	MOV 00,#F9;

	// UNI HORA
    MOV #F8,A;
	MOV A,B;
	SUB 03,A;
	JMPZ VALIDARDEZHORAS;
	JMP CONTINUAR;
	RET;

CONTINUAR:
	MOV B,A;
	ADD 01,A;
	MOV A,B;

	SUB 0A,A;
	JMPZ INCREMENTARDEZHORA;

	MOV B,A;
	MOV A,#F8;
	RET;

INCREMENTARDEZHORA:
// Zera unidade horas
	MOV 00,#F8;
	
	MOV #F7,A;
	ADD 01,A;
	MOV A,#F7;
	RET;

VALIDARDEZHORAS:
	// DEZ HORA
    MOV #F7,A;
	SUB 02,A;
    JMPZ RESETARHORA;
	JMP CONTINUAR;
	RET;
	
RESETARHORA:
	MOV 00,#F8;
	MOV 00,#F7;
	RET;

SHOWUNIMIN:
	MOV #FA,A;
	MOV A,OUT0;
	RET;

SHOWDEZMIN:
	MOV #F9,A;
	MOV A,OUT1;
	RET;

SHOWUNIHORA:
	MOV #F8,A;
	MOV A,OUT2;
	RET;

SHOWDEZHORA:
	MOV #F7,A;
	MOV A,OUT3;
	RET;









